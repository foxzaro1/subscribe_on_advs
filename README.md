## О проекте

Проект является тестовым заданием. Проект написан с  большими ограничениями и требуется в доработках для использования в реальной ситуации, я старался написать его на новом для себя фреймворке Laravel. Буду не против получения обратной связи.

## База данных 

Ключевые таблицы users и adverts, хорошей практикой было бы завести третью табличку и не перенагружать дополнительными запросами мой сервис, который обрабатывает имеющиеся в базе adverts, но я решил попробывать сделать это через json поле у users.advertIds и сделал не очень приятную для запросов привязку к полю таблицы adverts.id .
_______________________________________________________________________
Ключевые поля у таблицы users :
1)  id - идентификатор пользователя AI
2)  email - емэйл пользователя
3)  advertIds - json всех объявлений на который подписан пользователь
?) По хорошему тут бы нужно было добавить еще одно свойство status типа enum, которое бы включало в себя статусы по отправке email, чтобы поставить это все в очереди при большом объеме изменяемых объявлений и включающихся в них подписок, чтобы незаблокировали почтовый клиент за чрезмерную активность, переключать их в зависимости от рассылки, а потом обнулять статусы для повторного взаимодействия.
_______________________________________________________________________
Ключевые поля у таблицы adverts :
1)  id - идентификатор объявлений AI
2)  price - цена указанная в объявлении
3)  url - ссылка на объявление 
4)  advCode - код объявления для того, чтобы не записывать одно и тоже объявление дважды в случае разности поступающих ссылок (с/без www) и тд.
5)  update_at - время обновления объявления
?) По хорошему тут бы нужно было добавить еще одно свойство status типа enum, которое бы включало в себя статусы по парсингу, чтобы поставить это все в очереди при большом объеме объявлений и переключать их в зависимости от парсинга, а потом обнулять статусы для повторного парсинга.

## Фрагменты кода, решающие конкретные задачи

1) Подписка на изменение цены -> App\Services\ActionRecordUser
2) Отслеживание изменений цены -> App\Services\Action\Process && App\Services\Action\Parse
3) Отправка уведомления на почту -> App\Services\Action\Mailing && App\Mail\MailUpdateAdv
4) Работа с БД -> App\Services\Action\RecordUser && App\Services\Action\RecordAdvert && App\Services\Action\Process
5) Cron -> App\Console\Kernel

## Routes

1)Запись в бд объявления и  пользователя [/get_data?url='url'&email='email']: 
    1. url, такого типа -> https://www.avito.ru/sankt-peterburg/sport_i_otdyh/ninebot_max_30kmch_original_garantiya_2004470901
    2. email, такого типа -> test@gmail.com
2) Происходит непосредственно весь процессинг [/parse]

## Прочая информация

Отправка писем через smtp.gmail.com
Некоторые ограничения :
    Желательно иметь : валидные объявления, валидные email (Подразумевается,  что идет проверка на стороне отправляющего http запрос на запись)
    Желательно, чтобы объявление имело цену, иначе будет null до тех пор пока не появится цена.
    Весь процесинг в итоге выполняется на кроне и рассчитан на маленькую базу подписок.

